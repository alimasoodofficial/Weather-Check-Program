<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Weather Application</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>
<style>
    body {
        margin: 0;
        padding: 0;
    }

    .bg-grey {
        background-color: rgb(193, 193, 193);
    }

    .bg-blue-grad {
        background-image: linear-gradient(#9FCCFA, #0974F1);

    }

    .color-blue-grad {
        background-image: linear-gradient(#0974F1, #13202e);
        -webkit-text-fill-color: transparent;
        -webkit-background-clip: text;

    }

    .bg-white-light {
        background-color: rgba(255, 255, 255, 0.323);
        box-shadow: 10px 10px 4px #1f6a845d;
    }
    
    @media screen and (max-width:575px) {
       .fs-5px{
        font-size: 10px;
    } 
    }

    
</style>

<body>

    <div class="main-div bg-blue-grad d-flex align-items-center vh-100  justify-content-center p-2 ">

        <div
            class="main-card   p-3 py-4 p-md-5 rounded  bg-white-light d-flex flex-column align-items-center justify-content-center ">

            <form action="" class="weatherForm d-flex column-gap-1 ">
                <input type="text" name="" id="cityInput" class="city-input rounded border-0 ps-2 fs-5px "
                    placeholder="Enter a city name">
                <button type="submit" class="btn btn-primary fs-5px ">Get Weather</button>

            </form>
            <div class="WeatherCard flex-column align-items-center"> 
                <!-- all the important will be created here using JS-->
            </div>

        </div>

    </div>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <script>
        const weatherForm = document.querySelector('.weatherForm')
        const CityInput = document.querySelector('#cityInput')
        const weatherCard = document.querySelector('.WeatherCard')
        const apiKey = 'd38d67402796dcb7f9926b7e840ddb7d'

        weatherForm.addEventListener('submit', async event => {
            event.preventDefault()
            const city = CityInput.value;
            if (city) {

                try {
                    const weatherData = await getWeatherData(city)
                    DisplayWeatherInfo(weatherData)
                }
                catch (error) {
                    console.error("222", error)
                    displayError(error.message)
                }

            }
            else {
                displayError('Please Enter a city')

            }

        })


        async function getWeatherData(city) {
            const APIurl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}`;
            const response = await fetch(APIurl)
            // console.log(await response.json())
            if (!response.ok) {
                throw new Error("City Not Found⁉️")
            }
            return await response.json();
        }

        function DisplayWeatherInfo(data) {
            const { name: city, main: { temp, humidity }, weather: [{ description, id }] } = data;
            weatherCard.textContent = '';
            // weatherCard.style.display = 'flex';
            const cityDisplay = document.createElement('h1')
            const tempDisplay = document.createElement('p')
            const humidityDisplay = document.createElement('p')
            const descDisplay = document.createElement('p')
            const weatherEmoji = document.createElement('p')

            cityDisplay.className = 'Display-1 d-flex justify-content-center fw-bold  p-1 pt-3 m-0';
            tempDisplay.className = 'd-flex justify-content-center p-1 m-0 fw-bold display-1 color-blue-grad';
            humidityDisplay.className = 'd-flex justify-content-center fw-bold p-1 m-0';
            descDisplay.className = 'd-flex justify-content-center text-primary fw-bold p-1 m-0';
            weatherEmoji.className = 'd-flex justify-content-center p-1 m-0 display-1';

            cityDisplay.textContent = city;
            weatherCard.appendChild(cityDisplay)
            tempDisplay.textContent = `${(temp - 273.15).toFixed(1)}°C`;
            weatherCard.appendChild(tempDisplay)
            humidityDisplay.textContent = `Humidity: ${humidity}`;
            weatherCard.appendChild(humidityDisplay)
            descDisplay.textContent = description;
            weatherCard.appendChild(descDisplay)
            weatherEmoji.textContent = DisplayWeatherEmoji(id);
            weatherCard.appendChild(weatherEmoji)





        }

        function DisplayWeatherEmoji(WeatherID) {

            switch (true) {
                case (WeatherID >= 200 && WeatherID < 300):
                    return "⛈️"
                case (WeatherID >= 300 && WeatherID < 400):
                    return '🌧️'
                case (WeatherID >= 500 && WeatherID < 600):
                    return '🌧️'
                case (WeatherID >= 600 && WeatherID < 700):
                    return '❄️'
                case (WeatherID >= 700 && WeatherID < 800):
                    return '🌫️'
                case (WeatherID == 800):
                    return '☀️'
                case (WeatherID >= 801 && WeatherID < 810):
                    return '☁️'
                default:
                    return "❓"
            }
        }

        function displayError(message) {
            const errorDisplay = document.createElement("p")
            errorDisplay.className = 'errorDisplay d-flex pt-3 m-0 fs-4 fw-bold';
            errorDisplay.textContent = message
            weatherCard.textContent = ''
            weatherCard.appendChild(errorDisplay)


        }


    </script>
</body>

</html>